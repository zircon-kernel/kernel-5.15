# Kernel Directory
KERNEL_DIR=kernel-5.15
# Source common and architecture-specific build configurations
. ${ROOT_DIR}/${KERNEL_DIR}/build.config.common
. ${ROOT_DIR}/${KERNEL_DIR}/build.config.aarch64

DEFCONFIG=zircon_defconfig
PRE_DEFCONFIG_CMDS="
  KCONFIG_CONFIG=${ROOT_DIR}/${KERNEL_DIR}/arch/arm64/configs/${DEFCONFIG}
  ${ROOT_DIR}/${KERNEL_DIR}/scripts/kconfig/merge_config.sh -m -r \
    ${ROOT_DIR}/${KERNEL_DIR}/arch/arm64/configs/gki_defconfig \
    ${ROOT_DIR}/${KERNEL_DIR}/arch/arm64/configs/mgk_64_k515_defconfig \
    ${ROOT_DIR}/${KERNEL_DIR}/kernel/configs/zircon.config \
    ${ROOT_DIR}/${KERNEL_DIR}/kernel/configs/ok_google_global.config
"
POST_DEFCONFIG_CMDS="
  rm ${ROOT_DIR}/${KERNEL_DIR}/arch/arm64/configs/${DEFCONFIG}
"

MAKE_GOALS="
Image.gz
modules
"

FILES="
arch/arm64/boot/Image.gz
vmlinux
System.map
vmlinux.symvers
modules.builtin
modules.builtin.modinfo
"

ABI_OUT_TAG="mtk"
KMI_SYMBOL_LIST="android/abi_gki_aarch64_mtk"
GKI_MODULES_LIST="android/gki_aarch64_modules"
ABI_DEFINITION="android/abi_gki_aarch64.xml"

# Build Variant
TARGET_BUILD_VARIANT=user

# External Modules
EXT_MODULES="
  vendor/mediatek/kernel_modules/fpsgo_cus
  vendor/mediatek/kernel_modules/met_drv_v3
  vendor/mediatek/kernel_modules/connectivity/common
  vendor/mediatek/kernel_modules/connectivity/conninfra
  vendor/mediatek/kernel_modules/connectivity/connfem
  vendor/mediatek/kernel_modules/connectivity/gps/gps_stp
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v010
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v030
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v050
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v051
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v060
  vendor/mediatek/kernel_modules/connectivity/gps/data_link/plat/v061
  vendor/mediatek/kernel_modules/connectivity/gps/gps_pwr
  vendor/mediatek/kernel_modules/connectivity/gps/gps_scp
  vendor/mediatek/kernel_modules/gpu
  vendor/mediatek/kernel_modules/connectivity/fmradio
  vendor/mediatek/kernel_modules/connectivity/wlan/adaptor
  vendor/mediatek/kernel_modules/connectivity/wlan/adaptor/wlan_page_pool
  vendor/mediatek/kernel_modules/connectivity/bt/linux_v2
  vendor/mediatek/kernel_modules/hbt_driver_cus
"
